# Default values for unified-bootstrap-chart
# This configures both LLM RAG Bootstrap and Bootstrap-RAG components

# Global settings
global:
  repoURL: https://github.com/ritzshah/llm-rag-deployment.git
  targetRevision: update-token-v1
  cluster: in-cluster

# Unified ApplicationSet configuration for ArgoCD
applicationSet:
  enabled: true
  name: unified-bootstrap
  namespace: openshift-gitops
  labels:
    component: unified-bootstrap

# All components to deploy (both bootstrap and bootstrap-rag)
components:
  # Bootstrap components
  - name: ic-rhoai-operator
    path: helm-chart-new/unified-bootstrap-chart/templates/ic-rhoai-operator
    enabled: true
    category: bootstrap
  - name: ic-rhoai-installation
    path: helm-chart-new/unified-bootstrap-chart/templates/ic-rhoai-installation
    enabled: true
    category: bootstrap
  - name: ic-rhoai-configuration
    path: helm-chart-new/unified-bootstrap-chart/templates/ic-rhoai-configuration
    enabled: true
    category: bootstrap
  - name: ic-shared-minio-app
    path: helm-chart-new/unified-bootstrap-chart/templates/ic-shared-minio
    enabled: true
    category: bootstrap
  - name: ic-shared-database-app
    path: helm-chart-new/unified-bootstrap-chart/templates/ic-shared-database
    enabled: true
    category: bootstrap
  - name: ic-shared-milvus
    path: helm-chart-new/unified-bootstrap-chart/templates/ic-shared-milvus
    enabled: true
    category: bootstrap
  - name: ic-shared-llm-app
    path: helm-chart-new/unified-bootstrap-chart/templates/ic-shared-llm
    enabled: true
    category: bootstrap
  - name: pg-vector-deployment
    path: helm-chart-new/unified-bootstrap-chart/templates/pgvector-deployment
    enabled: true
    category: bootstrap
  - name: gradio
    path: helm-chart-new/unified-bootstrap-chart/templates/gradio
    enabled: true
    category: bootstrap
  - name: ic-shared-img-det
    path: helm-chart-new/unified-bootstrap-chart/templates/ic-shared-img-det
    enabled: true
    category: bootstrap
  - name: ic-user-projects
    path: helm-chart-new/unified-bootstrap-chart/templates/ic-user-projects
    enabled: true
    category: bootstrap
  - name: ic-shared-app
    path: helm-chart-new/unified-bootstrap-chart/templates/ic-shared-app
    enabled: true
    category: bootstrap

  # Bootstrap RAG components
  - name: shared-rag-minio-app
    path: helm-chart-new/unified-bootstrap-chart/templates/shared-rag-minio
    enabled: true
    category: bootstrap-rag
  - name: shared-rag-database-app
    path: helm-chart-new/unified-bootstrap-chart/templates/shared-rag-database
    enabled: true
    category: bootstrap-rag
  - name: shared-rag-llm-app
    path: helm-chart-new/unified-bootstrap-chart/templates/shared-rag-llm
    enabled: true
    category: bootstrap-rag
  - name: gradio-rag-app
    path: helm-chart-new/unified-bootstrap-chart/templates/gradio-rag
    enabled: true
    category: bootstrap-rag
  - name: pgvector-rag-deployment-app
    path: helm-chart-new/unified-bootstrap-chart/templates/pgvector-rag-deployment
    enabled: true
    category: bootstrap-rag
  - name: ds-rag-pipeline
    path: helm-chart-new/unified-bootstrap-chart/templates/ds-rag-pipelines
    enabled: true
    category: bootstrap-rag
  - name: rhoai-rag-configuration
    path: helm-chart-new/unified-bootstrap-chart/templates/rhoai-rag-configuration
    enabled: true
    category: bootstrap-rag
  - name: secret-create
    path: helm-chart-new/unified-bootstrap-chart/templates/secret-create
    enabled: true
    category: bootstrap-rag
  - name: odf-s3
    path: helm-chart-new/unified-bootstrap-chart/templates/odf-s3
    enabled: true
    category: bootstrap-rag
  - name: model-server
    path: helm-chart-new/unified-bootstrap-chart/templates/model-server
    enabled: true
    category: bootstrap-rag
  - name: workbench-image
    path: helm-chart-new/unified-bootstrap-chart/templates/workbench-image
    enabled: true
    category: bootstrap-rag
  # Optional workbench - disabled by default
  - name: workbench
    path: helm-chart-new/unified-bootstrap-chart/templates/notebook
    enabled: false
    category: bootstrap-rag

# Gradio UI Configuration (shared between bootstrap and bootstrap-rag)
gradio:
  enabled: true
  image:
    repository: quay.io/rshah/llm-rag-deployment-maas
    tag: latest
    pullPolicy: IfNotPresent
  
  replicas: 1
  
  resources:
    limits:
      cpu: "2"
      memory: 2Gi
    requests:
      cpu: "1"
      memory: 1Gi
  
  # Application configuration
  config:
    appTitle: "Talk with your documentation"
    bearerToken: "65fc80b0d55be557b1365687ddb771d6"  # Change this in production
    inferenceServerUrl: "https://granite-8b-code-instruct-maas-apicast-production.apps.llmaas.llmaas.redhatworkshops.io:443/v1/completions"
    modelName: "granite-8b-code-instruct-128k"
    dbConnectionString: "postgresql+psycopg://vectordb:vectordb@postgresql-service.ic-shared-llm.svc.cluster.local:5432/vectordb"
    dbCollectionName: "documents_test"
    maxNewTokens: "512"
    
  # Advanced model parameters
  modelParams:
    topK: "10"
    topP: "0.95"
    typicalP: "0.95"
    temperature: "0.01"
    repetitionPenalty: "1.03"
    
  # Debug settings
  debug:
    enableDebugUI: "False"
  
  # Service configuration
  service:
    type: ClusterIP
    port: 7860
    targetPort: 7860
    
  # Health checks
  probes:
    readiness:
      timeoutSeconds: 5
      periodSeconds: 30
      successThreshold: 1
      failureThreshold: 3
    liveness:
      timeoutSeconds: 8
      periodSeconds: 100
      successThreshold: 1
      failureThreshold: 3
    startup:
      timeoutSeconds: 1
      periodSeconds: 30
      successThreshold: 1
      failureThreshold: 24

# ArgoCD sync policy (shared across all ApplicationSets)
syncPolicy:
  automated:
    prune: true
    selfHeal: true
  syncOptions:
    - RespectIgnoreDifferences=true
    - Retry=true
  retry:
    limit: 50
    backoff:
      duration: 15s
      factor: 2
      maxDuration: 5m
